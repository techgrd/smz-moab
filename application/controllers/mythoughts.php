<?phpclass Mythoughts extends CI_Controller {	private $today;	private $datetime;	private $dateonly;	function __construct() {		parent::__construct();				//Load FB		$fbconfig = array(			"appId"		=>	"530656457064285",			"secret"	=>	"f9b5fec6eaf8a48d09180d082616cb04"		);		$this->load->library("facebook",$fbconfig);				$timezone = "Asia/Manila";		putenv ('TZ=' . $timezone);		$this->today = date('Y-m-d h:i:s');		$this->datetime = date('Ymd_his');		$this->dateonly = date('Y-m-d');			}		function submit() {		$this->load->model('mythoughts_model','thoughts');		$answers = $this->input->post('answers');		$question_id = $this->input->post('question_id');		$others = $this->input->post('others');		$fbid = $this->facebook->getUser();				//get total respondents of current question		$total_answers = $this->thoughts->count_answers($question_id);		$answered = $this->thoughts->user_has_answered($fbid);				if($answered == 1) {					if($total_answers > 100) {						$data = array(							"total_answers"	=> $total_answers,							"message"		=> "<h1>This question already has 100 respondents. <br />Next question will be shown soon.</h1>"						);				echo json_encode($data);						} else {							$data = array(							"total_answers"	=> $total_answers,							"message"		=> "<h1>You have already answered this question.</h1>"						);				echo json_encode($data);						}					} else {					if($total_answers > 100) {						$data = array(							"total_answers"	=> $total_answers,							"message"		=> "<h1>This question already has 100 respondents. <br />Next question will be shown soon.</h1>"						);				echo json_encode($data);						} else {							$data = array(							"fbid"				=>	$fbid,							"answer_code"		=>	implode(",",$answers),							"question_id"		=>	$question_id,							"others"			=>	$others,							"date_submitted"	=>	$this->today						);				$this->thoughts->insert($data);								$data['total_answers'] = $total_answers;				$updated_total = $total_answers + 1;				$data['message'] = "<h1>Thank you for sharing your thoughts. <br />You are our respondent #".$updated_total."</h1>";				echo json_encode($data);			}				}			}		function submit2() {		$this->load->model('mythoughts2_model','thoughts');		$answer = $this->input->post('answer');		$question_id = $this->input->post('question_id');		$fbid = $this->facebook->getUser();				//get total respondents of current question		$total_answers = $this->thoughts->count_answers($question_id);		$answered = $this->thoughts->user_has_answered($fbid);				if($answered == 1) {					if($total_answers > 100) {						$data = array(							"total_answers"	=> $total_answers,							"message"		=> "<h1>This question already has 100 respondents. <br />Next question will be shown soon.</h1>"						);				echo json_encode($data);						} else {							$data = array(							"total_answers"	=> $total_answers,							"message"		=> "<h1>You have already answered this question.</h1>"						);				echo json_encode($data);						}					} else {					if($total_answers > 100) {						$data = array(							"total_answers"	=> $total_answers,							"message"		=> "<h1>This question already has 100 respondents. <br />Next question will be shown soon.</h1>"						);				echo json_encode($data);						} else {							$data = array(							"fbid"				=>	$fbid,							"answer"			=>	$answer,							"question_id"		=>	$question_id,							"date_submitted"	=>	$this->today						);				$this->thoughts->insert($data);								$data['total_answers'] = $total_answers;				$updated_total = $total_answers + 1;				$data['message'] = "<h1>Thank you for sharing your thoughts. <br />You are our respondent #".$updated_total."</h1>";				echo json_encode($data);			}				}			}}?>